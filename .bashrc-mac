# Set the paths
PATH=~/bin:/opt/local/bin:/opt/local/sbin:/usr/local/bin:/usr/local/sbin:/Volumes/Data/jesse/.gem/ruby/1.8/bin:~/dev/android/tools:~/dev/android/platform-tools:${PATH}

# leverage nventory for ssh connections
nvssh () {
  ssh $(nv --exclude status=decom --name $1 | head -n1)
}

nvrssh () {
  ssh -l root $(nv --exclude status=decom --name $1 | head -n1)
}

nvcssh () {
  csshX $(nv --exclude status=decom --name $1 | awk -v ORS=' ' 1)
}
nvrcssh () {
  csshX -l root $(nv --exclude status=decom --name $1 | awk -v ORS=' ' 1)
}

nvami () {
  nv  --objecttype node_groups --exactget name=aws1 --get graffitis[name]=$1 --fields value
}

nvlistami () {
  nv --objecttype node_groups --exactget name=aws1 --get graffitis[name]=ami --field name,value
}
getnvgroup () {
  nv --objecttype node_groups --exactget name=$1 --field description,owner
}
ppkick () {
  SERVERS=$(nv --exclude status=decom --name $1 | awk -v ORS=' ' 1)
  for SERVER in $SERVERS; do
    echo "Triggering puppet run on $SERVER"
    tickle $SERVER &
  done
}
tickle () {
  ssh $1 "telnet 127.0.0.1 7140"
}

# AWS tools
if [[ -d $HOME/dev/git/cg-cloud-tools ]]; then
  AWS_BASE_DIR=$HOME/dev/git/cg-cloud-tools
  AWS_CONF_DIR=$HOME/dev/git/cg-cloud-tools-conf/etc
  AWS_CRED_DIR=$HOME/dev/creds/aws
  PROJECT_CRED_DIR=$HOME/dev/creds/project_cred
  PROJECT_BASE_DIR=$HOME/dev/git/cg-cloud-tools-cluster-files
  PYTHONPATH=$PYTHONPATH:${AWS_BASE_DIR}/python_libs:/Users/escobedoj/dev/boto:${AWS_BASE_DIR}/bin
  PATH=${PATH}:${AWS_BASE_DIR}/bin
  export AWS_BASE_DIR AWS_CONF_DIR AWS_CRED_DIR PROJECT_CRED_DIR PROJECT_BASE_DIR PYTHONPATH PATH

  # Generate aws alias profiles for each account
  for account in $(find $AWS_CRED_DIR -mindepth 1 -maxdepth 1 -type d -print | sed 's@.*/@@'); do
    alias aws${account}="unset AWS_CREDENTIAL_FILE
    eval \`awsprofile ${account}\`"
  done

fi

# set title prompts
export PROMPT_COMMAND='echo -ne "\033]0;${USER}@${HOSTNAME%%.*}\007"'
